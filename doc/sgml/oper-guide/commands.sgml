  <chapter id="commands">
    <title>Operator Commands</title>
    <sect1>
      <title>Network management commands</title>
      <note>
	<para>
	  Except STATS letters, all commands and names are case insensitive.
	</para>
      </note>
      <sect2>
	<title>CONNECT</title>
	<cmdsynopsis><command>CONNECT</command> 
	  <arg choice=plain><replaceable>target</replaceable></arg> 
	  <arg><replaceable>port</replaceable></arg> 
	  <arg><replaceable>source</replaceable></arg>
	</cmdsynopsis>
	<para>
	  Initiate a connection attempt to server <replaceable class=parameter>target</replaceable>. If a port is
	  given, connect to that port on the target, otherwise use the one given in ircd.conf. If 
	  <replaceable class=parameter>source</replaceable> is given, tell that server to initiate the connection
	  attempt, otherwise it will be made from the server you are attached to.
	</para>
      </sect2>
      <sect2>
	<title>SQUIT</title>
	<cmdsynopsis>
	  <command>SQUIT</command>
	  <arg choice=plain><replaceable>server</replaceable></arg>
	  <arg><replaceable>reason</replaceable></arg>
	</cmdsynopsis>
	<para>
	  Closes down the link to <replaceable>server</replaceable> from this side of the network. If a reason is
	  given, it will be sent out in the server notices on both sides of the link.
	</para>
      </sect2>
      <sect2>
	<title>REHASH</title>
	<cmdsynopsis>
	  <command>REHASH</command>
	  <group>
	    <arg>BANS</arg>
	    <arg>DNS</arg>
	    <arg>MOTD</arg>
	    <arg>OMOTD</arg>
	    <arg>GLINES</arg>
	    <arg>PGLINES</arg>
	    <arg>TKLINES</arg>
	    <arg>TDLINES</arg>
	    <arg>TXLINES</arg>
	    <arg>TRESVS</arg>
	    <arg>REJECTCACHE</arg>
	    <arg>HELP</arg>
	  </group>
	  <arg><replaceable>server</replaceable></arg>
	</cmdsynopsis>
	<para>
	  With no parameter given, ircd.conf will be re-read and parsed.
	  The server argument is a wildcard match of server names.
	</para>
	<variablelist>
	  <title>Parameters</title>
	  <varlistentry>
	    <term>BANS</term>
	    <listitem>
	      <para>Re-reads kline.conf, dline.conf, resv.conf, xline.conf and their .perm variants</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>DNS</term>
	    <listitem>
	      <para>Re-read /etc/resolv.conf.</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>MOTD</term>
	    <listitem>
	      <para>Reload the MOTD file</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>OMOTD</term>
	    <listitem>
	      <para>Reload the operator MOTD file</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>GLINES</term>
	    <listitem>
	      <para>Clears G-Lines.</para>
	      <para>This option is being deprecated in Charybdis 
                    1.1, as EFnet-style G:Line is being removed.</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>PGLINES</term>
	    <listitem>
	      <para>Clears pending G-Lines.</para>
	      <para>This option is being deprecated in Charybdis 
                    1.1, as EFnet-style G:Line is being removed.</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>TKLINES</term>
	    <listitem>
	      <para>Clears temporary K-Lines.</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>TDLINES</term>
	    <listitem>
	      <para>Clears temporary D-Lines.</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>TXLINES</term>
	    <listitem>
	      <para>Clears temporary X-Lines.</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>TRESVS</term>
	    <listitem>
	      <para>Clears temporary reservations.</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>REJECTCACHE</term>
	    <listitem>
	      <para>Clears the client rejection cache.</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>HELP</term>
	    <listitem>
	      <para>Refreshes the help system cache.</para>
	    </listitem>
	  </varlistentry>
	</variablelist>
      </sect2>
      <sect2>
	<title>RESTART</title>
	<cmdsynopsis>
	  <command>RESTART</command>
	  <arg choice=plain><replaceable>server</replaceable></arg>
	</cmdsynopsis>
	<para>
	  Cause an immediate total shutdown of the IRC server, and restart from scratch as if it had just been executed.
	</para>
	<note>
	  <para>This command cannot be used remotely. The server name is used only as a safety measure.</para>
	</note>
      </sect2>
      <sect2>
	<title>DIE</title>
	<cmdsynopsis>
	  <command>DIE</command>
	  <arg choice=plain><replaceable>server</replaceable></arg>
	</cmdsynopsis>
	<para>Immediately terminate the IRC server, after sending notices to all connected clients and servers</para>
	<note>
	  <para>This command cannot be used remotely. The server name is used only as a safety measure.</para>
	</note>
      </sect2>
      <sect2>
	<title>SET</title>
	<cmdsynopsis>
	  <command>SET</command>
	  <group>
	    <arg>LOG</arg>
	    <arg>MAX</arg>
	    <arg>SPLITDELAY</arg>
	    <arg>SMALLNET</arg>
	    <arg>SPAMNUM</arg>
	    <arg>SPAMTIME</arg>
	  </group>
	  <arg choice=plain><replaceable>value</replaceable></arg>
	</cmdsynopsis>
	<para>The SET command sets a runtime-configurable value</para>
	<variablelist>
	  <varlistentry>
	    <term>LOG</term>
	    <listitem>
	      <para>Logging level for ircd.log and syslog</para>
	    </listitem>
	  </varlistentry>
	</variablelist>
	<variablelist>
	  <varlistentry>
	    <term>MAX</term>
	    <listitem>
	      <para>Set the maximum connections allowed (may not exceed the compiled-in value HARD_FDLIMIT)</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>DRONETIME</term>
	    <listitem>
	      <para>Number of seconds in which DRONECOUNT messages must occur to trip the drone alarm</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>DRONECOUNT</term>
	    <listitem>
	      <para>Number of messages which constitutes a drone flood. 0 disables drone flood checking.</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>SPLITDELAY</term>
	    <listitem>
	      <para>Number of minutes after a connect burst begins until joining an empty channel will give you ops</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>SMALLNET</term>
	    <listitem>
	      <para>Sets the number of servers which are needed to constitute "attached to the network", as opposed to "split"</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>SPAMNUM</term>
	    <listitem>
	      <para>Sets the number of JOINs/PARTs which constitutes a possible spambot</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>SPAMTIME</term>
	    <listitem>
	      <para>Staying on a channel for less than this length of time adds to the SPAMNUM count</para>
	    </listitem>
	  </varlistentry>
	</variablelist>
      </sect2>
    </sect1>
    <sect1 id="usercommands">
      <title>User management commands</title>
      <sect2>
	<title>KILL</title>
	<cmdsynopsis>
	  <command>KILL</command>
	  <arg choice=plain><replaceable>nick</replaceable></arg>
	  <arg><replaceable>reason</replaceable></arg>
	</cmdsynopsis>
	<para>
	  Disconnects the user with the given nick from the server they are connected to,
	  with the reason given, if present, and broadcast a server notice announcing this.
	</para>
      </sect2>
      <sect2>
	<title>CLOSE</title>
	<para>
	  Closes all connections from and to clients and servers who have not completed registering.
	</para>
      </sect2>
      <sect2>
	<title>KLINE</title>
	<cmdsynopsis>
	  <command>KLINE</command>
	  <arg><replaceable>length</replaceable></arg>
	  <group>
	    <arg><replaceable>nick</replaceable></arg>
	    <arg><replaceable>user</replaceable>@<replaceable>host</replaceable></arg>
	    <arg><replaceable>user</replaceable>@<replaceable>a</replaceable>.<replaceable>b</replaceable>.<replaceable>c</replaceable>.<replaceable>d</replaceable></arg>
	  </group>
	  <arg>:<replaceable>reason</replaceable></arg>
	</cmdsynopsis>
	<para>
	  Add a K:line to the local server config file to ban the given user from using that
	  server. If a nick is given, the user@host they currently have will be banned, otherwise
	  the ban will be directly added.
	</para>
	<para>
	  If the optional parameter <replaceable>length</replaceable> is given, the K:line will
	  be temporary (i.e. it will not be stored on disk) and last that
	  long in minutes.
	</para>
	<para>
	  If an IP address is given, the ban will be against all hosts matching that IP regardless
	  of DNS. The IP address can be given as a full address (192.168.0.1), as a CIDR mask
	  (192.168.0.0/24), or as a glob (192.168.0.*).
	</para>
	<para>
	  All clients matching the K:line will be disconnected from the server immediately.
	</para>
	<para>
	  If a reason is specified, it will be sent to the client when they are disconnected, and
	  whenever a connection is attempted which is banned.
	</para>
	<para>
	  If specified in the configuration file, the K:Line will be propagated across the network.
	</para>
      </sect2>
      <sect2>
	<title>UNKLINE</title>
	<cmdsynopsis>
	  <command>UNKLINE</command>
	  <arg choice=plain><replaceable>user</replaceable>@<replaceable>host</replaceable></arg>
	</cmdsynopsis>
	<para>
	  Will attempt to remove a K:line matching user@host from the config files, and will flush
	  a temporary K:line.
	</para>
      </sect2>
      <sect2>
	<title>DLINE</title>
	<cmdsynopsis>
	  <command>DLINE</command>
	  <group>
	    <arg><replaceable>nick</replaceable></arg>
	    <arg><replaceable>a</replaceable>.<replaceable>b</replaceable>.<replaceable>c</replaceable>.<replaceable>d</replaceable></arg>
	  </group>
	  <arg>:<replaceable>reason</replaceable></arg>
	</cmdsynopsis>
	<para>
	  Add a D:line to the config files, which will deny any connections from the IP
	  address of the banned client (either the address given, or the address of the
	  user specified).
	</para>
	<para>
	  If a reason is specified, it will be sent to the client when they are disconnected, and
	  whenever a connection is attempted which is banned.
	</para>
	<para>
	  D:lines are less load on a server, and may be more appropriate if somebody is flooding
	  connections.
	</para>
      </sect2>
      <sect2>
	<title>TESTGECOS</title>
	<cmdsynopsis>
	  <command>TESTGECOS</command>
	  <arg><replaceable>mask</replaceable></arg>
	</cmdsynopsis>
	<para>
	  Looks up the amount of X:Lines which match a given gecosmask.
	</para>
      </sect2>
      <sect2>
	<title>TESTLINE</title>
	<cmdsynopsis>
	  <command>TESTLINE</command>
	  <group>
	    <arg><replaceable>user</replaceable>@<replaceable>host</replaceable></arg>
	    <arg><replaceable>a</replaceable>.<replaceable>b</replaceable>.<replaceable>c</replaceable>.<replaceable>d</replaceable></arg>
	  </group>
	</cmdsynopsis>
	<para>
	  Looks up the given hostmask or IP address and reports back on any I:, D:, G:, or K: lines found.
	</para>
      </sect2>
      <sect2>
	<title>TESTMASK</title>
	<cmdsynopsis>
	  <command>TESTMASK</command>
	  <arg><replaceable>user</replaceable>@<replaceable>host</replaceable></arg>
	</cmdsynopsis>
	<para>
	  Looks up the given hostmask and reports back on any local or global users found.
	</para>
      </sect2>
      <sect2>
	<title>TRACE</title>
	<cmdsynopsis>
	  <command>TRACE</command>
	  <group>
	    <arg><replaceable>server</replaceable></arg>
	    <arg><replaceable>nick</replaceable></arg>
	  </group>
	</cmdsynopsis>
	<para>
	  Shows client information about the given target, or about the current server if
	  no target is specified.
	  The path to the target will also be given.
	</para>
      </sect2>
      <sect2>
	<title>ETRACE</title>
	<cmdsynopsis>
	  <command>ETRACE</command>
	  <arg><replaceable>nick</replaceable></arg>
	</cmdsynopsis>
	<para>
	  Shows client information about the given target, or about all local clients if
	  no target is specified.
	</para>
      </sect2>
      <sect2>
        <title>MASKTRACE</title>
        <cmdsynopsis>
          <command>MASKTRACE</command>
          <arg choice=plain><replaceable>hostmask</replaceable></arg>
	  <arg choice=plain><replaceable>gecos</replaceable></arg>
        </cmdsynopsis>
        <para>
          Searches the local server or network for users that match the hostmask and gecos given.
	  Network searches require the oper_spy privilege and an '!'
	  before the hostmask.
        </para>
      </sect2>
      <sect2>
        <title>CHANTRACE</title>
        <cmdsynopsis>
          <command>CHANTRACE</command>
          <arg choice=plain><replaceable>channel</replaceable></arg>
        </cmdsynopsis>
        <para>
	  Displays information about users in a channel.
	  Opers with the oper_spy privilege
	  can get the information without being on the channel,
	  by prefixing the channel name with an '!'.
        </para>
      </sect2>
      <sect2>
	<title>CHGHOST</title>
	<cmdsynopsis>
	  <command>CHGHOST</command>
	  <arg choice=plain><replaceable>nick</replaceable></arg>
	  <arg choice=plain><replaceable>value</replaceable></arg>
	</cmdsynopsis>
	<para>
	  Set the hostname associated with a particular nick for the duration of this session.
	  This command is disabled by default because of the abuse potential
	  and little practical use.
	</para>
      </sect2>
    </sect1>
    <sect1 id="misccommands">
      <title>Miscellaneous commands</title>
      <sect2>
	<title>STATS</title>
	<cmdsynopsis>
	  <command>STATS</command>
	  <arg><replaceable>type</replaceable></arg>
	  <group>
	    <arg><replaceable>nick</replaceable></arg>
	    <arg><replaceable>server</replaceable></arg>
	  </group>
	</cmdsynopsis>
	<para>
	  Display various statistics.
	</para>
	<variablelist>
	  <title>Values for <replaceable>type</replaceable></title>
	  <varlistentry>
	    <term>A</term>
	    <listitem>
	      <para>Show DNS servers</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>b</term>
	    <listitem>
	      <para>Show active nick delays</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>B</term>
	    <listitem>
	      <para>Show hash statistics</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>c</term>
	    <listitem>
	      <para>Show connect blocks</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>d</term>
	    <listitem>
	      <para>Show temporary D:lines</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>D</term>
	    <listitem>
	      <para>Show permanent D:lines</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>e</term>
	    <listitem>
	      <para>Show exempt blocks</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>f</term>
	    <listitem>
	      <para>Show file descriptors</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>g</term>
	    <listitem>
	      <para>Show pending glines</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>G</term>
	    <listitem>
	      <para>Show active glines</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>h</term>
	    <listitem>
	      <para>Show hub_mask/leaf_mask</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>i</term>
	    <listitem>
	      <para>Show auth blocks</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>k</term>
	    <listitem>
	      <para>Show temporary K:lines, or matched temporary K:lines</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>K</term>
	    <listitem>
	      <para>Show permanent K:lines, or matched permanent K:lines</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>L</term>
	    <listitem>
	      <para>Show IP and generic information about the given nick</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>l</term>
	    <listitem>
	      <para>Show hostname and generic information about the given nick</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>m</term>
	    <listitem>
	      <para>Show commands and their usage statistics</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>o</term>
	    <listitem>
	      <para>Show operator blocks</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>p</term>
	    <listitem>
	      <para>Show logged on network operators which are not set AWAY.</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>P</term>
	    <listitem>
	      <para>Show listen blocks</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>q</term>
	    <listitem>
	      <para>Show temporarily resv'ed nicks and channels</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>Q</term>
	    <listitem>
	      <para>Show permanently resv'ed nicks and channels</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>r</term>
	    <listitem>
	      <para>Show resource usage by the ircd</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>t</term>
	    <listitem>
	      <para>Show generic server statistics</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>u</term>
	    <listitem>
	      <para>Show server uptime</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>U</term>
	    <listitem>
	      <para>Show shared (c), cluster (C) and service (s) blocks</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>v</term>
	    <listitem>
	      <para>Show connected servers and brief status</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>x</term>
	    <listitem>
	      <para>Show temporary X:lines</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>x</term>
	    <listitem>
	      <para>Show permanent X:lines</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>y</term>
	    <listitem>
	      <para>Show class blocks</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>z</term>
	    <listitem>
	      <para>Show memory usage statistics</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>Z</term>
	    <listitem>
	      <para>Show ziplinks statistics</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>?</term>
	    <listitem>
	      <para>Show connected servers and sendq information about them</para>
	    </listitem>
	  </varlistentry>
	</variablelist>
      </sect2>
      <sect2>
	<title>WALLOPS</title>
	<cmdsynopsis>
	  <command>WALLOPS</command>
	  <arg choice=plain>:<replaceable>message</replaceable></arg>
	</cmdsynopsis>
	<para>
	  Sends a WALLOPS message to all users who have the +w umode set. This is for
	  things you don't mind the whole network knowing about.
	</para>
      </sect2>
      <sect2>
	<title>OPERWALL</title>
	<cmdsynopsis>
	  <command>OPERWALL</command>
	  <arg choice=plain>:<replaceable>message</replaceable></arg>
	</cmdsynopsis>
	<para>
	  Sends an OPERWALL message to all opers who have the +z umode set. +z is restricted,
	  OPERWALL should be considered private communications.
	</para>
      </sect2>
    </sect1>
  </chapter>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-namecase-general:t
sgml-general-insert-case:lower
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:2
sgml-indent-data:t
sgml-parent-document: ("charybdis-oper-guide.sgml" "book")
sgml-exposed-tags:nil
sgml-local-ecat-files:nil
fill-column:105
End:
-->
